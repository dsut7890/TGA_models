clear
%all the constants
M0=216;
dTdt=10/60; %heating rate

%prefactors
Akpyr=5.0118e15;

kpyr=@(a) (1/dTdt)*Akpyr*4*(1-(a/M0)).*(-(-(a/M0)-(((a/M0).^2)/2)-(((a/M0).^3)/3)-...
          (((a/M0).^4)/4)-(((a/M0).^5)/5)-(((a/M0).^6)/6) - ...
          (((a/M0).^7)/7)-(((a/M0).^8)/8)-(((a/M0).^9)/9) - ...
          (((a/M0).^10)/10)-(((a/M0).^11)/11)-(((a/M0).^12)/12)- ...
          (((a/M0).^13)/13)-(((a/M0).^14)/14)-(((a/M0).^15)/15)- ...
          (((a/M0).^16)/16)-(((a/M0).^17)/17)-(((a/M0).^18)/18)- ...
          (((a/M0).^19)/19)-(((a/M0).^20)/20)-(((a/M0).^21)/21)- ...
          (((a/M0).^22)/22)-(((a/M0).^23)/23)-(((a/M0).^24)/24)- ...
          (((a/M0).^25)/25)-(((a/M0).^26)/26)-(((a/M0).^27)/27)- ...
          (((a/M0).^28)/28)-(((a/M0).^29)/29)-(((a/M0).^30)/30)- ...
          (((a/M0).^31)/31)-(((a/M0).^32)/32)-(((a/M0).^33)/33)- ...
          (((a/M0).^34)/34)-(((a/M0).^35)/35)-(((a/M0).^36)/36)- ...
          (((a/M0).^37)/37)-(((a/M0).^38)/38)-(((a/M0).^39)/39)- ...
          (((a/M0).^41)/40)-(((a/M0).^42)/42)-(((a/M0).^43)/43) ...
          )).^0.75;%(-(log((1-a/M0)))).^(3/4);

JMA=@(a) (1/dTdt)*Akpyr*4*(1-(a/M0)).*(-(log((1-a/M0)))).^(3/4);

order=10;
x=[0:0.01:0.9999*M0];

figure(1)
clf
hold on
box on
plot(x,kpyr(x),'ro')
plot(x,JMA(x),'b')

err=100*norm(kpyr(x)-JMA(x),2)./norm(kpyr(x),2)

stop


